let origBoard,huPlayer='<img src="21s9.png"/>',aiPlayer='<img src="cnc9.png"/>';const winCombos=[[0,1,2],[3,4,5],[6,7,8],[0,4,8],[6,4,2],[2,5,8],[1,4,7],[0,3,6]],cells=document.querySelectorAll(".cell");function selectSym(e){huPlayer=e="X"===e?'<img src="21s9.png"/>':'<img src="cnc9.png"/>',aiPlayer='<img src="21s9.png"/>'===e?'<img src="cnc9.png"/>':'<img src="21s9.png"/>',origBoard=Array.from(Array(9).keys());for(let e=0;e<cells.length;e++)cells[e].addEventListener("click",turnClick,!1);'<img src="cnc9.png"/>'===aiPlayer&&turn(bestSpot(),aiPlayer),document.querySelector(".selectSym").style.display="none"}function startGame(){document.querySelector(".endgame").style.display="none",document.querySelector(".endgame .text").innerText="",document.querySelector(".selectSym").style.display="block";for(let e=0;e<cells.length;e++)cells[e].innerText="",cells[e].style.removeProperty("background-color")}function turnClick(e){"number"==typeof origBoard[e.target.id]&&(turn(e.target.id,huPlayer),checkWin(origBoard,huPlayer)||checkTie()||turn(bestSpot(),aiPlayer))}function turn(e,r){origBoard[e]=r,document.getElementById(e).innerHTML=r;let n=checkWin(origBoard,r);n&&gameOver(n),checkTie()}function checkWin(e,r){let n=e.reduce(((e,n,l)=>n===r?e.concat(l):e),[]),l=null;for(let[e,t]of winCombos.entries())if(t.every((e=>n.indexOf(e)>-1))){l={index:e,player:r};break}return l}function gameOver(e){for(let r of winCombos[e.index])document.getElementById(r).style.backgroundColor=e.player===huPlayer?"blue":"red";for(let e=0;e<cells.length;e++)cells[e].removeEventListener("click",turnClick,!1);declareWinner(e.player===huPlayer?"You win!":"You lose"),e.player!=huPlayer&&setTimeout((()=>{window.close()}),1e3)}function declareWinner(e){document.querySelector(".endgame").style.display="block",document.querySelector(".endgame .text").innerText=e}function emptySquares(){return origBoard.filter(((e,r)=>r===e))}function bestSpot(){return minimax(origBoard,aiPlayer).index}function checkTie(){if(0===emptySquares().length){for(cell of cells)cell.style.backgroundColor="green",cell.removeEventListener("click",turnClick,!1);return declareWinner("Tie game"),setTimeout((()=>{window.close()}),1e3),!0}return!1}function minimax(e,r){var n=emptySquares(e);if(checkWin(e,huPlayer))return{score:-10};if(checkWin(e,aiPlayer))return{score:10};if(0===n.length)return{score:0};var l=[];for(let c=0;c<n.length;c++){var t={};if(t.index=e[n[c]],e[n[c]]=r,t.score=r===aiPlayer?minimax(e,huPlayer).score:minimax(e,aiPlayer).score,e[n[c]]=t.index,r===aiPlayer&&10===t.score||r===huPlayer&&-10===t.score)return t;l.push(t)}let c,o;if(r===aiPlayer){o=-1e3;for(let e=0;e<l.length;e++)l[e].score>o&&(o=l[e].score,c=e)}else{o=1e3;for(let e=0;e<l.length;e++)l[e].score<o&&(o=l[e].score,c=e)}return l[c]}startGame();
